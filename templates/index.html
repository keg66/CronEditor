<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CronEditor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Cron Job Editor</h1>
            <a href="/dev" class="dev-link">üõ†Ô∏è Developer Panel</a>
        </div>

        {% if jobs %}
        <div class="cron-jobs">
            {% for job in jobs %}
            <div class="job-row{% if not job.enabled %} disabled{% endif %}" data-job-id="{{ job.id }}">
                <div class="job-display">
                    <div class="job-time">
                        <span class="time-part">{{ job.minute }}</span>
                        <span class="time-part">{{ job.hour }}</span>
                        <span class="time-part">{{ job.day }}</span>
                        <span class="time-part">{{ job.month }}</span>
                        <span class="time-part">{{ job.weekday }}</span>
                    </div>
                    <div class="job-command">{{ job.command }}</div>
                    <div class="job-status">
                        <input type="checkbox" {% if job.enabled %}checked{% endif %} disabled>
                        <label>{% if job.enabled %}ÊúâÂäπ{% else %}ÁÑ°Âäπ{% endif %}</label>
                    </div>
                    <div class="job-actions">
                        <button class="edit-btn" onclick="editJob({{ job.id }})">Á∑®ÈõÜ</button>
                    </div>
                </div>

                <div class="job-edit" style="display: none;">
                    <div class="mode-toggle">
                        <button type="button" class="toggle-btn" onclick="toggleEditMode({{ job.id }})">
                            <span class="toggle-text">È´òÂ∫¶„Å™Ë®≠ÂÆö</span>
                        </button>
                    </div>

                    <!-- Simple Mode (Dropdowns) -->
                    <div class="job-time-edit simple-mode">
                        <div class="time-field-simple">
                            <label>ÂàÜ</label>
                            <select class="time-select" data-field="minute">
                                <option value="*" {% if job.minute == "*" %}selected{% endif %}>*</option>
                                {% for i in range(60) %}
                                <option value="{{ i }}" {% if job.minute == i|string %}selected{% endif %}>{{ "%02d"|format(i) }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="time-field-simple">
                            <label>ÊôÇ</label>
                            <select class="time-select" data-field="hour">
                                <option value="*" {% if job.hour == "*" %}selected{% endif %}>*</option>
                                {% for i in range(24) %}
                                <option value="{{ i }}" {% if job.hour == i|string %}selected{% endif %}>{{ "%02d"|format(i) }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="time-field-simple">
                            <label>Êó•</label>
                            <select class="time-select" data-field="day">
                                <option value="*" {% if job.day == "*" %}selected{% endif %}>*</option>
                                {% for i in range(1, 32) %}
                                <option value="{{ i }}" {% if job.day == i|string %}selected{% endif %}>{{ i }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="time-field-simple">
                            <label>Êúà</label>
                            <select class="time-select" data-field="month">
                                <option value="*" {% if job.month == "*" %}selected{% endif %}>*</option>
                                {% for i in range(1, 13) %}
                                <option value="{{ i }}" {% if job.month == i|string %}selected{% endif %}>{{ i }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="time-field-simple">
                            <label>ÊõúÊó•</label>
                            <select class="time-select" data-field="weekday">
                                <option value="*" {% if job.weekday == "*" %}selected{% endif %}>*</option>
                                <option value="0" {% if job.weekday == "0" %}selected{% endif %}>Êó•</option>
                                <option value="1" {% if job.weekday == "1" %}selected{% endif %}>Êúà</option>
                                <option value="2" {% if job.weekday == "2" %}selected{% endif %}>ÁÅ´</option>
                                <option value="3" {% if job.weekday == "3" %}selected{% endif %}>Ê∞¥</option>
                                <option value="4" {% if job.weekday == "4" %}selected{% endif %}>Êú®</option>
                                <option value="5" {% if job.weekday == "5" %}selected{% endif %}>Èáë</option>
                                <option value="6" {% if job.weekday == "6" %}selected{% endif %}>Âúü</option>
                                <option value="7" {% if job.weekday == "7" %}selected{% endif %}>Êó•</option>
                            </select>
                        </div>
                    </div>

                    <!-- Advanced Mode (Text Inputs) -->
                    <div class="job-time-edit advanced-mode" style="display: none;">
                        <div class="time-field">
                            <label>ÂàÜ</label>
                            <input type="text" class="time-input" data-field="minute" value="{{ job.minute }}"
                                   placeholder="‰æã: *, 0, */5, 1-30, 0,15,30,45" title="ÂàÜ (0-59, *, */n, x-y, x,y,z)">
                        </div>
                        <div class="time-field">
                            <label>ÊôÇ</label>
                            <input type="text" class="time-input" data-field="hour" value="{{ job.hour }}"
                                   placeholder="‰æã: *, 9, */2, 9-17, 6,12,18" title="ÊôÇ (0-23, *, */n, x-y, x,y,z)">
                        </div>
                        <div class="time-field">
                            <label>Êó•</label>
                            <input type="text" class="time-input" data-field="day" value="{{ job.day }}"
                                   placeholder="‰æã: *, 1, */7, 1-15, 1,15" title="Êó• (1-31, *, */n, x-y, x,y,z)">
                        </div>
                        <div class="time-field">
                            <label>Êúà</label>
                            <input type="text" class="time-input" data-field="month" value="{{ job.month }}"
                                   placeholder="‰æã: *, 1, */3, 1-6, 3,6,9,12" title="Êúà (1-12, *, */n, x-y, x,y,z)">
                        </div>
                        <div class="time-field">
                            <label>ÊõúÊó•</label>
                            <input type="text" class="time-input" data-field="weekday" value="{{ job.weekday }}"
                                   placeholder="‰æã: *, 0, mon-fri, sat,sun" title="ÊõúÊó• (0-7, *, mon-sun, x,y,z)">
                        </div>
                    </div>
                    <div class="job-command">{{ job.command }}</div>
                    <div class="job-status-edit">
                        <input type="checkbox" class="enabled-checkbox" {% if job.enabled %}checked{% endif %}>
                        <label>ÊúâÂäπ</label>
                    </div>
                    <div class="job-actions-edit">
                        <button class="save-btn" onclick="saveJob({{ job.id }})">‰øùÂ≠ò</button>
                        <button class="cancel-btn" onclick="cancelEdit({{ job.id }})">„Ç≠„É£„É≥„Çª„É´</button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p>Cron„Ç∏„Éß„Éñ„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„ÄÇ</p>
        {% endif %}

        <div id="message" class="message"></div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>